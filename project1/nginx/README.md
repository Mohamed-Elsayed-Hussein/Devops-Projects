# Nginx Reverse Proxy (HTTPS)

This directory contains the reverse proxy that fronts the Go backend over HTTPS.
It forwards incoming requests to the backend service running on the internal network.

## Contents

- `Dockerfile` — Builds the Nginx image with configuration and certificates.
- `nginx.conf` — Nginx configuration with upstream pointing to the backend.
- `generate-ssl.sh` — Helper script to generate self-signed TLS certificates for development.

## How It Works

- Listens on HTTPS (port 443) inside the container.
- Proxies requests to the backend service at `backend:8000` on the `go-backend` network.
- Sets standard proxy headers: `Host`, `X-Real-IP`, `X-Forwarded-For`, `X-Forwarded-Proto`.
- Uses self-signed certificates generated by `generate-ssl.sh` (development only).

## Build and Run (Direct Docker)

1) Generate self-signed certs (if not already present inside the image build process):

```
./generate-ssl.sh
```

2) Build the image:

```
docker build -t reverse-proxy:v1.0 .
```

3) Run the container connected to both the backend network and the external port map:

```
# Assuming the go-backend network already exists
# Expose HTTPS on host port 8080 -> container 443

docker run -d --name reverse-proxy \
  --network go-backend \
  -p 8080:443 \
  reverse-proxy:v1.0
```

## Run with Docker Compose

From the project root (`project1`):

```
docker compose up -d --build proxy
```

This will:
- Build the Nginx image from this directory
- Attach it to `go-backend` and `reverse-proxy` networks
- Expose host port `8080` to container port `443`

## Verify

Once running, test via HTTPS (self-signed):

```
curl -k https://localhost:8080/
```

Expected: JSON response proxied from the backend.

Note: A plain HTTP request to `8080` will return `400 Bad Request` because the proxy expects TLS on that port.

## Notes

- Self-signed certificates are for local development only. For production, use proper certificates (e.g., via Let’s Encrypt) and secure configurations.
- The backend must be reachable at `backend:8000` on the `go-backend` network for the proxy to function correctly.